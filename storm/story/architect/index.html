<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZeroStorm Story Architect - Interactive Story Builder</title>

<!-- 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ZEROSTORM STORY ARCHITECT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
A collaborative authoring tool for creating rich interactive narratives.

PURPOSE: Make story creation ridiculously easy through:
- Guided brainstorming prompts
- AI collaboration suggestions
- Visual story mapping
- Instant code generation
- No coding knowledge required

ZERO-HARM: Tool for creative empowerment, not manipulation.
All stories respect reader agency and dignity.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->

<style>
:root {
  --primary: #8b4dff;
  --primary-light: #a366ff;
  --secondary: #d4af37;
  --bg-dark: #1a0f2e;
  --bg-light: #2d1b4e;
  --text: #ffffff;
  --text-muted: #b8a4d4;
  --success: #00ff88;
  --warning: #ffa500;
  --paper: #f4e8d8;
  --ink: #2c1810;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', system-ui, sans-serif;
  background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-light) 100%);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Header */
.header {
  background: rgba(0, 0, 0, 0.3);
  backdrop-filter: blur(10px);
  padding: 20px 40px;
  border-bottom: 2px solid var(--primary);
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 1000;
}

.logo {
  display: flex;
  align-items: center;
  gap: 15px;
}

.logo-icon {
  font-size: 2.5rem;
}

.logo-text h1 {
  font-size: 1.5rem;
  background: linear-gradient(90deg, var(--primary-light), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.logo-text p {
  font-size: 0.85rem;
  color: var(--text-muted);
}

.header-actions {
  display: flex;
  gap: 15px;
}

.btn {
  padding: 12px 24px;
  border: 2px solid var(--primary);
  background: rgba(139, 77, 255, 0.2);
  color: var(--text);
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.btn:hover {
  background: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 5px 20px rgba(139, 77, 255, 0.4);
}

.btn-secondary {
  border-color: var(--secondary);
  background: rgba(212, 175, 55, 0.2);
}

.btn-secondary:hover {
  background: var(--secondary);
  color: var(--ink);
}

.btn-success {
  border-color: var(--success);
  background: rgba(0, 255, 136, 0.2);
}

.btn-success:hover {
  background: var(--success);
  color: var(--ink);
}

/* Main Layout */
.container {
  max-width: 1600px;
  margin: 0 auto;
  padding: 40px 20px;
}

.wizard-container {
  display: grid;
  grid-template-columns: 350px 1fr;
  gap: 30px;
  min-height: calc(100vh - 200px);
}

/* Sidebar Navigation */
.sidebar {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 15px;
  padding: 30px;
  border: 2px solid var(--primary);
  height: fit-content;
  position: sticky;
  top: 120px;
}

.sidebar h2 {
  margin-bottom: 20px;
  color: var(--secondary);
  font-size: 1.3rem;
}

.step-list {
  list-style: none;
}

.step-item {
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  gap: 12px;
  border: 2px solid transparent;
}

.step-item:hover {
  background: rgba(139, 77, 255, 0.1);
  border-color: var(--primary);
}

.step-item.active {
  background: rgba(139, 77, 255, 0.3);
  border-color: var(--primary-light);
}

.step-item.completed {
  background: rgba(0, 255, 136, 0.1);
  border-color: var(--success);
}

.step-number {
  width: 30px;
  height: 30px;
  border-radius: 50%;
  background: var(--primary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.step-item.completed .step-number {
  background: var(--success);
}

.step-label {
  flex: 1;
}

/* Main Content Area */
.content-area {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 15px;
  padding: 40px;
  border: 2px solid var(--primary);
  min-height: 600px;
}

.step-content {
  display: none;
}

.step-content.active {
  display: block;
  animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.step-title {
  font-size: 2rem;
  margin-bottom: 15px;
  background: linear-gradient(90deg, var(--primary-light), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.step-subtitle {
  color: var(--text-muted);
  font-size: 1.1rem;
  margin-bottom: 30px;
  line-height: 1.6;
}

/* Form Elements */
.form-group {
  margin-bottom: 25px;
}

.form-label {
  display: block;
  margin-bottom: 8px;
  color: var(--secondary);
  font-weight: 600;
  font-size: 1.05rem;
}

.form-input,
.form-textarea,
.form-select {
  width: 100%;
  padding: 15px;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(139, 77, 255, 0.3);
  border-radius: 8px;
  color: var(--text);
  font-size: 1rem;
  transition: all 0.3s;
  font-family: inherit;
}

.form-input:focus,
.form-textarea:focus,
.form-select:focus {
  outline: none;
  border-color: var(--primary);
  background: rgba(255, 255, 255, 0.08);
  box-shadow: 0 0 20px rgba(139, 77, 255, 0.2);
}

.form-textarea {
  min-height: 150px;
  resize: vertical;
  line-height: 1.6;
}

.form-hint {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-top: 5px;
  font-style: italic;
}

/* AI Suggestions */
.ai-suggestions {
  background: linear-gradient(135deg, rgba(139, 77, 255, 0.15), rgba(212, 175, 55, 0.15));
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 25px;
  margin: 25px 0;
}

.ai-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
}

.ai-icon {
  font-size: 2rem;
}

.ai-title {
  font-size: 1.3rem;
  color: var(--secondary);
}

.suggestion-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 15px;
}

.suggestion-card {
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(139, 77, 255, 0.3);
  border-radius: 8px;
  padding: 15px;
  cursor: pointer;
  transition: all 0.3s;
}

.suggestion-card:hover {
  border-color: var(--primary);
  background: rgba(139, 77, 255, 0.2);
  transform: translateY(-3px);
  box-shadow: 0 5px 20px rgba(139, 77, 255, 0.3);
}

.suggestion-card h4 {
  color: var(--secondary);
  margin-bottom: 8px;
}

.suggestion-card p {
  font-size: 0.9rem;
  color: var(--text-muted);
  line-height: 1.5;
}

/* Chapter Builder */
.chapter-builder {
  display: grid;
  gap: 20px;
}

.choice-builder {
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(139, 77, 255, 0.3);
  border-radius: 12px;
  padding: 25px;
  position: relative;
}

.choice-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.choice-number {
  background: var(--primary);
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 1.2rem;
}

.remove-choice {
  padding: 8px 16px;
  background: rgba(255, 0, 0, 0.2);
  border: 2px solid #ff4444;
  border-radius: 8px;
  color: var(--text);
  cursor: pointer;
  font-size: 0.9rem;
  transition: all 0.3s;
}

.remove-choice:hover {
  background: #ff4444;
}

.add-choice-btn {
  width: 100%;
  padding: 20px;
  background: rgba(0, 255, 136, 0.1);
  border: 2px dashed var(--success);
  border-radius: 12px;
  color: var(--success);
  cursor: pointer;
  font-size: 1.1rem;
  font-weight: 600;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.add-choice-btn:hover {
  background: rgba(0, 255, 136, 0.2);
  transform: translateY(-3px);
}

/* Story Map */
.story-map {
  background: rgba(0, 0, 0, 0.3);
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 30px;
  min-height: 400px;
  position: relative;
  overflow: auto;
}

.map-node {
  background: linear-gradient(135deg, rgba(139, 77, 255, 0.3), rgba(212, 175, 55, 0.3));
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 20px;
  cursor: pointer;
  transition: all 0.3s;
}

.map-node:hover {
  border-color: var(--secondary);
  box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
}

.map-node h4 {
  color: var(--secondary);
  margin-bottom: 10px;
  font-size: 1.2rem;
}

.map-connections {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 15px;
}

.connection-badge {
  background: rgba(139, 77, 255, 0.3);
  border: 2px solid var(--primary);
  border-radius: 20px;
  padding: 5px 15px;
  font-size: 0.85rem;
  display: inline-flex;
  align-items: center;
  gap: 5px;
}

/* Preview Panel */
.preview-panel {
  background: var(--paper);
  color: var(--ink);
  border-radius: 12px;
  padding: 40px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
  font-family: Georgia, serif;
  line-height: 1.8;
}

.preview-title {
  font-size: 2rem;
  color: var(--primary);
  margin-bottom: 20px;
  text-align: center;
}

.preview-text {
  font-size: 1.1rem;
  margin-bottom: 30px;
  text-align: justify;
}

.preview-choice {
  background: linear-gradient(135deg, #ffffff, var(--paper));
  border: 3px solid var(--secondary);
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 15px;
  cursor: pointer;
  transition: all 0.3s;
}

.preview-choice:hover {
  border-color: var(--primary);
  transform: translateX(8px);
  box-shadow: 0 5px 20px rgba(139, 77, 255, 0.3);
}

/* Code Output */
.code-output {
  background: #1e1e1e;
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 25px;
  font-family: 'Courier New', monospace;
  color: #d4d4d4;
  overflow-x: auto;
  position: relative;
}

.code-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(139, 77, 255, 0.3);
}

.code-title {
  color: var(--secondary);
  font-family: 'Segoe UI', sans-serif;
}

.copy-code-btn {
  padding: 8px 16px;
  background: var(--primary);
  border: none;
  border-radius: 6px;
  color: white;
  cursor: pointer;
  font-family: 'Segoe UI', sans-serif;
  transition: all 0.3s;
}

.copy-code-btn:hover {
  background: var(--primary-light);
}

pre {
  margin: 0;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.code-keyword { color: #569cd6; }
.code-string { color: #ce9178; }
.code-number { color: #b5cea8; }
.code-comment { color: #6a9955; font-style: italic; }
.code-property { color: #9cdcfe; }

/* Navigation Footer */
.step-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 40px;
  padding-top: 30px;
  border-top: 2px solid rgba(139, 77, 255, 0.3);
}

.progress-indicator {
  color: var(--text-muted);
  font-size: 0.95rem;
}

.nav-buttons {
  display: flex;
  gap: 15px;
}

/* Brainstorm Prompts */
.prompt-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.prompt-card {
  background: linear-gradient(135deg, rgba(139, 77, 255, 0.1), rgba(212, 175, 55, 0.1));
  border: 2px solid var(--primary);
  border-radius: 12px;
  padding: 25px;
  transition: all 0.3s;
}

.prompt-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(139, 77, 255, 0.3);
  border-color: var(--secondary);
}

.prompt-icon {
  font-size: 2.5rem;
  margin-bottom: 15px;
}

.prompt-title {
  font-size: 1.3rem;
  color: var(--secondary);
  margin-bottom: 10px;
}

.prompt-question {
  color: var(--text);
  font-size: 1rem;
  line-height: 1.6;
  margin-bottom: 15px;
}

.prompt-input {
  width: 100%;
  padding: 12px;
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(139, 77, 255, 0.3);
  border-radius: 8px;
  color: var(--text);
  font-size: 0.95rem;
  transition: all 0.3s;
}

.prompt-input:focus {
  outline: none;
  border-color: var(--primary);
  background: rgba(255, 255, 255, 0.08);
}

/* Tooltips */
.tooltip {
  position: relative;
  display: inline-block;
  cursor: help;
}

.tooltip-icon {
  color: var(--secondary);
  font-size: 1.2rem;
  margin-left: 5px;
}

.tooltip-text {
  visibility: hidden;
  background-color: rgba(0, 0, 0, 0.95);
  color: var(--text);
  text-align: left;
  border-radius: 8px;
  padding: 15px;
  position: absolute;
  z-index: 1000;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  width: 300px;
  opacity: 0;
  transition: opacity 0.3s;
  border: 2px solid var(--primary);
  font-size: 0.9rem;
  line-height: 1.5;
}

.tooltip:hover .tooltip-text {
  visibility: visible;
  opacity: 1;
}

/* Responsive */
@media (max-width: 1200px) {
  .wizard-container {
    grid-template-columns: 1fr;
  }
  
  .sidebar {
    position: static;
  }
}

@media (max-width: 768px) {
  .header {
    padding: 15px 20px;
  }
  
  .logo-text h1 {
    font-size: 1.2rem;
  }
  
  .content-area {
    padding: 25px;
  }
  
  .suggestion-grid,
  .prompt-cards {
    grid-template-columns: 1fr;
  }
}

/* Success Animation */
@keyframes successPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); box-shadow: 0 0 40px var(--success); }
}

.success-indicator {
  color: var(--success);
  animation: successPulse 2s infinite;
}

/* Loading Spinner */
.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: var(--primary);
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="logo">
    <div class="logo-icon">âœ¨</div>
    <div class="logo-text">
      <h1>ZeroStorm Story Architect</h1>
      <p>Collaborative Interactive Story Builder</p>
    </div>
  </div>
  <div class="header-actions">
    <button class="btn btn-secondary" onclick="saveProgress()">
      ğŸ’¾ Save Progress
    </button>
    <button class="btn btn-success" onclick="exportStory()">
      ğŸš€ Export Story
    </button>
  </div>
</header>

<!-- Main Container -->
<div class="container">
  <div class="wizard-container">
    
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <h2>Story Creation Steps</h2>
      <ul class="step-list">
        <li class="step-item active" data-step="1" onclick="goToStep(1)">
          <div class="step-number">1</div>
          <div class="step-label">Brainstorm</div>
        </li>
        <li class="step-item" data-step="2" onclick="goToStep(2)">
          <div class="step-number">2</div>
          <div class="step-label">Opening Chapter</div>
        </li>
        <li class="step-item" data-step="3" onclick="goToStep(3)">
          <div class="step-number">3</div>
          <div class="step-label">Build Choices</div>
        </li>
        <li class="step-item" data-step="4" onclick="goToStep(4)">
          <div class="step-number">4</div>
          <div class="step-label">Add Branches</div>
        </li>
        <li class="step-item" data-step="5" onclick="goToStep(5)">
          <div class="step-label">Story Map</div>
        </li>
        <li class="step-item" data-step="6" onclick="goToStep(6)">
          <div class="step-number">6</div>
          <div class="step-label">Preview & Test</div>
        </li>
        <li class="step-item" data-step="7" onclick="goToStep(7)">
          <div class="step-number">7</div>
          <div class="step-label">Export Code</div>
        </li>
      </ul>
      
      <div style="margin-top: 30px; padding: 20px; background: rgba(0, 255, 136, 0.1); border: 2px solid var(--success); border-radius: 10px;">
        <h3 style="color: var(--success); font-size: 1rem; margin-bottom: 10px;">ğŸ’¡ AI Tip</h3>
        <p style="font-size: 0.85rem; color: var(--text-muted); line-height: 1.5;">
          Click any AI suggestion to auto-fill forms. Collaborate with the AI to refine your story!
        </p>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="content-area">
      
      <!-- Step 1: Brainstorm -->
      <div class="step-content active" data-step="1">
        <h2 class="step-title">ğŸŒŸ Let's Brainstorm Your Story</h2>
        <p class="step-subtitle">
          Answer these questions to shape your interactive narrative. The AI will suggest ideas based on your answers!
        </p>

        <div class="prompt-cards">
          <div class="prompt-card">
            <div class="prompt-icon">ğŸ­</div>
            <h3 class="prompt-title">Genre & Tone</h3>
            <p class="prompt-question">What genre and mood are you aiming for?</p>
            <input type="text" class="prompt-input" id="genre" 
                   placeholder="e.g., Sci-fi mystery with hopeful tone"
                   oninput="updateAISuggestions()">
          </div>

          <div class="prompt-card">
            <div class="prompt-icon">âš¡</div>
            <h3 class="prompt-title">Core Conflict</h3>
            <p class="prompt-question">What's the central challenge or mystery?</p>
            <input type="text" class="prompt-input" id="conflict"
                   placeholder="e.g., A dimensional rift threatens reality"
                   oninput="updateAISuggestions()">
          </div>

          <div class="prompt-card">
            <div class="prompt-icon">ğŸ¯</div>
            <h3 class="prompt-title">Player Agency</h3>
            <p class="prompt-question">What meaningful choices will players make?</p>
            <input type="text" class="prompt-input" id="agency"
                   placeholder="e.g., Choose between knowledge and power"
                   oninput="updateAISuggestions()">
          </div>

          <div class="prompt-card">
            <div class="prompt-icon">âœ¨</div>
            <h3 class="prompt-title">Unique Element</h3>
            <p class="prompt-question">What makes your story special?</p>
            <input type="text" class="prompt-input" id="unique"
                   placeholder="e.g., Player's words shape reality"
                   oninput="updateAISuggestions()">
          </div>

          <div class="prompt-card">
            <div class="prompt-icon">ğŸŒˆ</div>
            <h3 class="prompt-title">Emotional Journey</h3>
            <p class="prompt-question">How should players feel by the end?</p>
            <input type="text" class="prompt-input" id="emotion"
                   placeholder="e.g., Empowered and curious"
                   oninput="updateAISuggestions()">
          </div>

          <div class="prompt-card">
            <div class="prompt-icon">ğŸ”®</div>
            <h3 class="prompt-title">World Details</h3>
            <p class="prompt-question">Describe your story's setting</p>
            <input type="text" class="prompt-input" id="world"
                   placeholder="e.g., Floating islands in a storm"
                   oninput="updateAISuggestions()">
          </div>
        </div>

        <div class="ai-suggestions" id="brainstorm-suggestions">
          <div class="ai-header">
            <span class="ai-icon">ğŸ¤–</span>
            <h3 class="ai-title">AI Story Suggestions</h3>
          </div>
          <p style="color: var(--text-muted); margin-bottom: 20px;">
            As you fill in the prompts above, the AI will suggest story elements here...
          </p>
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 1 of 7</div>
          <div class="nav-buttons">
            <button class="btn btn-success" onclick="nextStep()">
              Next: Opening Chapter â†’
            </button>
          </div>
        </div>
      </div>

      <!-- Step 2: Opening Chapter -->
      <div class="step-content" data-step="2">
        <h2 class="step-title">ğŸ“– Craft Your Opening</h2>
        <p class="step-subtitle">
          This is where your story begins. Set the scene, introduce the conflict, and hook your readers.
        </p>

        <div class="form-group">
          <label class="form-label">
            Chapter Title
            <span class="tooltip">
              <span class="tooltip-icon">â„¹ï¸</span>
              <span class="tooltip-text">
                A compelling title that hints at what's to come. Keep it evocative and mysterious!
              </span>
            </span>
          </label>
          <input type="text" class="form-input" id="chapter-title"
                 placeholder="e.g., The Awakening">
        </div>

        <div class="form-group">
          <label class="form-label">
            Opening Text
            <span class="tooltip">
              <span class="tooltip-icon">â„¹ï¸</span>
              <span class="tooltip-text">
                Write 2-4 paragraphs that establish mood, setting, and the initial situation. 
                Use sensory details and create intrigue!
              </span>
            </span>
          </label>
          <textarea class="form-textarea" id="chapter-text" rows="10"
                    placeholder="A rift tears open the sky above, purple lightning cascading through dimensions..."></textarea>
          <p class="form-hint">ğŸ’¡ Tip: Use vivid imagery and end with a compelling question or dilemma</p>
        </div>

        <div class="ai-suggestions">
          <div class="ai-header">
            <span class="ai-icon">ğŸ¤–</span>
            <h3 class="ai-title">AI Writing Prompts for ChatGPT</h3>
          </div>
          <div class="suggestion-grid">
            <div class="suggestion-card" onclick="copyPrompt('opening1')">
              <h4>ğŸ¬ Opening Scene</h4>
              <p>"Write an opening paragraph for a <span id="genre-ref">story</span> that begins with <span id="conflict-ref">a conflict</span>"</p>
            </div>
            <div class="suggestion-card" onclick="copyPrompt('opening2')">
              <h4>ğŸŒ World Building</h4>
              <p>"Describe the setting of <span id="world-ref">this world</span> through sensory details"</p>
            </div>
            <div class="suggestion-card" onclick="copyPrompt('opening3')">
              <h4>ğŸ­ Hook Reader</h4>
              <p>"Write a mysterious opening that makes readers ask 'what happens next?'"</p>
            </div>
          </div>
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 2 of 7</div>
          <div class="nav-buttons">
            <button class="btn" onclick="prevStep()">â† Back</button>
            <button class="btn btn-success" onclick="nextStep()">Next: Add Choices â†’</button>
          </div>
        </div>
      </div>

      <!-- Step 3: Build Choices -->
      <div class="step-content" data-step="3">
        <h2 class="step-title">ğŸ”€ Create Player Choices</h2>
        <p class="step-subtitle">
          Give players meaningful decisions. Each choice should feel distinct and lead somewhere interesting.
        </p>

        <div id="choices-container" class="chapter-builder">
          <!-- Choices will be added dynamically -->
        </div>

        <button class="add-choice-btn" onclick="addChoice()">
          <span>â•</span>
          <span>Add Another Choice</span>
        </button>

        <div class="ai-suggestions">
          <div class="ai-header">
            <span class="ai-icon">ğŸ¤–</span>
            <h3 class="ai-title">AI Choice Design Tips</h3>
          </div>
          <div class="suggestion-grid">
            <div class="suggestion-card">
              <h4>ğŸ¯ Meaningful Impact</h4>
              <p>Each choice should have clear consequences. Avoid "correct" answers - make all paths valid</p>
            </div>
            <div class="suggestion-card">
              <h4>âš–ï¸ Balance Costs</h4>
              <p>Mix free choices with ones requiring resources. Higher costs = greater rewards</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸ­ Distinct Voices</h4>
              <p>Give choices different tones: bold, cautious, creative, analytical</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸ”® Hint Outcomes</h4>
              <p>Descriptions should telegraph (but not spoil) what each path offers</p>
            </div>
          </div>
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 3 of 7</div>
          <div class="nav-buttons">
            <button class="btn" onclick="prevStep()">â† Back</button>
            <button class="btn btn-success" onclick="nextStep()">Next: Add Branches â†’</button>
          </div>
        </div>
      </div>

      <!-- Step 4: Add Branch Chapters -->
      <div class="step-content" data-step="4">
        <h2 class="step-title">ğŸŒ³ Expand Your Story Branches</h2>
        <p class="step-subtitle">
          For each choice you created, add a follow-up chapter. You can keep branching to create a rich narrative tree!
        </p>

        <div id="branches-container">
          <!-- Branch chapters will be populated based on choices -->
        </div>

        <div class="ai-suggestions">
          <div class="ai-header">
            <span class="ai-icon">ğŸ¤–</span>
            <h3 class="ai-title">Branching Narrative Strategies</h3>
          </div>
          <div class="suggestion-grid">
            <div class="suggestion-card">
              <h4>ğŸ”„ Convergence</h4>
              <p>Multiple paths can lead to the same outcome - vary the journey, not just destination</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸ“Š Depth vs Breadth</h4>
              <p>3-5 choices with 3 layers deep > 10 choices with 1 layer. Quality over quantity</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸ’ Secret Paths</h4>
              <p>Hide special choices behind requirements (items, skills) to reward exploration</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸª Variety</h4>
              <p>Mix action, dialogue, exploration, and reflection across branches</p>
            </div>
          </div>
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 4 of 7</div>
          <div class="nav-buttons">
            <button class="btn" onclick="prevStep()">â† Back</button>
            <button class="btn btn-success" onclick="nextStep()">Next: View Story Map â†’</button>
          </div>
        </div>
      </div>

      <!-- Step 5: Story Map -->
      <div class="step-content" data-step="5">
        <h2 class="step-title">ğŸ—ºï¸ Your Story Map</h2>
        <p class="step-subtitle">
          Visualize how all your chapters connect. Click any node to edit it.
        </p>

        <div class="story-map" id="story-map">
          <!-- Story map will be generated dynamically -->
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 5 of 7</div>
          <div class="nav-buttons">
            <button class="btn" onclick="prevStep()">â† Back</button>
            <button class="btn btn-success" onclick="nextStep()">Next: Preview Story â†’</button>
          </div>
        </div>
      </div>

      <!-- Step 6: Preview -->
      <div class="step-content" data-step="6">
        <h2 class="step-title">ğŸ‘ï¸ Preview Your Story</h2>
        <p class="step-subtitle">
          See how your story will look to readers. Test the flow and make adjustments.
        </p>

        <div class="preview-panel" id="preview-panel">
          <!-- Live preview will be rendered here -->
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 6 of 7</div>
          <div class="nav-buttons">
            <button class="btn" onclick="prevStep()">â† Back</button>
            <button class="btn btn-success" onclick="nextStep()">Next: Export Code â†’</button>
          </div>
        </div>
      </div>

      <!-- Step 7: Export -->
      <div class="step-content" data-step="7">
        <h2 class="step-title">ğŸš€ Export Your Story</h2>
        <p class="step-subtitle">
          Your interactive story is ready! Copy the code below and paste it into the ZeroStorm framework.
        </p>

        <div class="code-output">
          <div class="code-header">
            <h3 class="code-title">Generated Chapter Code</h3>
            <button class="copy-code-btn" onclick="copyCode()">ğŸ“‹ Copy All</button>
          </div>
          <pre id="generated-code"></pre>
        </div>

        <div style="margin-top: 30px;">
          <h3 style="color: var(--secondary); margin-bottom: 15px;">ğŸ“š Next Steps</h3>
          <ol style="line-height: 2; color: var(--text-muted);">
            <li>Copy the generated code above</li>
            <li>Open your ZeroStorm storybook HTML file</li>
            <li>Find the <code style="background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 4px;">chapters</code> object in JavaScript SECTION 3</li>
            <li>Paste your new chapters into the chapters object</li>
            <li>Save and open in your browser to test!</li>
          </ol>
        </div>

        <div class="ai-suggestions">
          <div class="ai-header">
            <span class="ai-icon">ğŸ¤–</span>
            <h3 class="ai-title">Ready for More?</h3>
          </div>
          <div class="suggestion-grid">
            <div class="suggestion-card">
              <h4>ğŸ¨ Add Items</h4>
              <p>Create collectible items that unlock special story paths</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸ”§ Craft Recipes</h4>
              <p>Let players combine items to create powerful artifacts</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸŒŸ Secret Choices</h4>
              <p>Hide special options behind skill requirements</p>
            </div>
            <div class="suggestion-card">
              <h4>ğŸ—³ï¸ Add Voting</h4>
              <p>Let players vote on major story directions with Fate Tokens</p>
            </div>
          </div>
        </div>

        <div class="step-footer">
          <div class="progress-indicator">Step 7 of 7 - Complete! ğŸ‰</div>
          <div class="nav-buttons">
            <button class="btn" onclick="prevStep()">â† Back</button>
            <button class="btn btn-success" onclick="downloadStory()">ğŸ’¾ Download HTML</button>
          </div>
        </div>
      </div>

    </main>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let currentStep = 1;
let storyData = {
  brainstorm: {
    genre: '',
    conflict: '',
    agency: '',
    unique: '',
    emotion: '',
    world: ''
  },
  chapters: {
    start: {
      title: '',
      text: '',
      choices: []
    }
  }
};

// Initialize first choice
function initializeChoices() {
  addChoice();
  addChoice();
  addChoice();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function goToStep(step) {
  // Save current step data
  saveStepData();
  
  // Update UI
  currentStep = step;
  
  // Hide all steps
  document.querySelectorAll('.step-content').forEach(el => {
    el.classList.remove('active');
  });
  
  // Show target step
  document.querySelector(`.step-content[data-step="${step}"]`).classList.add('active');
  
  // Update sidebar
  document.querySelectorAll('.step-item').forEach(el => {
    const stepNum = parseInt(el.dataset.step);
    el.classList.remove('active', 'completed');
    
    if (stepNum === step) {
      el.classList.add('active');
    } else if (stepNum < step) {
      el.classList.add('completed');
    }
  });
  
  // Load step-specific data
  loadStepData();
  
  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function nextStep() {
  if (currentStep < 7) {
    goToStep(currentStep + 1);
  }
}

function prevStep() {
  if (currentStep > 1) {
    goToStep(currentStep - 1);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STEP DATA MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function saveStepData() {
  switch(currentStep) {
    case 1: // Brainstorm
      storyData.brainstorm.genre = document.getElementById('genre')?.value || '';
      storyData.brainstorm.conflict = document.getElementById('conflict')?.value || '';
      storyData.brainstorm.agency = document.getElementById('agency')?.value || '';
      storyData.brainstorm.unique = document.getElementById('unique')?.value || '';
      storyData.brainstorm.emotion = document.getElementById('emotion')?.value || '';
      storyData.brainstorm.world = document.getElementById('world')?.value || '';
      break;
      
    case 2: // Opening Chapter
      storyData.chapters.start.title = document.getElementById('chapter-title')?.value || '';
      storyData.chapters.start.text = document.getElementById('chapter-text')?.value || '';
      break;
      
    case 3: // Choices
      saveChoices();
      break;
  }
  
  // Save to localStorage
  localStorage.setItem('zerostorm_story', JSON.stringify(storyData));
}

function loadStepData() {
  // Try to load from localStorage
  const saved = localStorage.getItem('zerostorm_story');
  if (saved) {
    storyData = JSON.parse(saved);
  }
  
  switch(currentStep) {
    case 1: // Brainstorm
      document.getElementById('genre').value = storyData.brainstorm.genre;
      document.getElementById('conflict').value = storyData.brainstorm.conflict;
      document.getElementById('agency').value = storyData.brainstorm.agency;
      document.getElementById('unique').value = storyData.brainstorm.unique;
      document.getElementById('emotion').value = storyData.brainstorm.emotion;
      document.getElementById('world').value = storyData.brainstorm.world;
      updateAISuggestions();
      break;
      
    case 2: // Opening Chapter
      document.getElementById('chapter-title').value = storyData.chapters.start.title;
      document.getElementById('chapter-text').value = storyData.chapters.start.text;
      updateReferences();
      break;
      
    case 3: // Choices
      renderChoices();
      break;
      
    case 5: // Story Map
      renderStoryMap();
      break;
      
    case 6: // Preview
      renderPreview();
      break;
      
    case 7: // Export
      generateCode();
      break;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BRAINSTORM SUGGESTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function updateAISuggestions() {
  const genre = document.getElementById('genre').value;
  const conflict = document.getElementById('conflict').value;
  const unique = document.getElementById('unique').value;
  
  const container = document.getElementById('brainstorm-suggestions');
  
  if (!genre && !conflict && !unique) {
    container.innerHTML = `
      <div class="ai-header">
        <span class="ai-icon">ğŸ¤–</span>
        <h3 class="ai-title">AI Story Suggestions</h3>
      </div>
      <p style="color: var(--text-muted); margin-bottom: 20px;">
        As you fill in the prompts above, the AI will suggest story elements here...
      </p>
    `;
    return;
  }
  
  let suggestions = `
    <div class="ai-header">
      <span class="ai-icon">ğŸ¤–</span>
      <h3 class="ai-title">AI Story Suggestions</h3>
    </div>
    <p style="color: var(--text-muted); margin-bottom: 20px;">
      Based on your inputs, here are some narrative elements to consider:
    </p>
    <div class="suggestion-grid">
  `;
  
  if (genre) {
    suggestions += `
      <div class="suggestion-card">
        <h4>ğŸ¬ Opening Hook</h4>
        <p>Start with a visceral moment that showcases your ${genre} setting. Drop readers into action immediately.</p>
      </div>
    `;
  }
  
  if (conflict) {
    suggestions += `
      <div class="suggestion-card">
        <h4>âš¡ Escalation</h4>
        <p>The conflict (${conflict}) should become more urgent with each choice. Start small, build to climax.</p>
      </div>
    `;
  }
  
  if (unique) {
    suggestions += `
      <div class="suggestion-card">
        <h4>âœ¨ Unique Mechanic</h4>
        <p>Your unique element (${unique}) could unlock special choices or reveal hidden story paths.</p>
      </div>
    `;
  }
  
  suggestions += `
    <div class="suggestion-card">
      <h4>ğŸ”® ChatGPT Prompt</h4>
      <p>"Generate 5 opening lines for a ${genre || 'story'} where ${conflict || 'the protagonist faces a challenge'}"</p>
    </div>
  </div>
  `;
  
  container.innerHTML = suggestions;
  
  // Update references in other steps
  updateReferences();
}

function updateReferences() {
  const genre = document.getElementById('genre')?.value || 'story';
  const conflict = document.getElementById('conflict')?.value || 'a conflict';
  const world = document.getElementById('world')?.value || 'this world';
  
  const genreRefs = document.querySelectorAll('#genre-ref');
  genreRefs.forEach(el => el.textContent = genre);
  
  const conflictRefs = document.querySelectorAll('#conflict-ref');
  conflictRefs.forEach(el => el.textContent = conflict);
  
  const worldRefs = document.querySelectorAll('#world-ref');
  worldRefs.forEach(el => el.textContent = world);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHOICE BUILDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let choiceCount = 0;

function addChoice() {
  choiceCount++;
  const container = document.getElementById('choices-container');
  
  const choiceDiv = document.createElement('div');
  choiceDiv.className = 'choice-builder';
  choiceDiv.dataset.choiceId = choiceCount;
  
  choiceDiv.innerHTML = `
    <div class="choice-header">
      <div class="choice-number">${choiceCount}</div>
      <button class="remove-choice" onclick="removeChoice(${choiceCount})">ğŸ—‘ï¸ Remove</button>
    </div>
    
    <div class="form-group">
      <label class="form-label">Choice Icon (emoji)</label>
      <input type="text" class="form-input" data-field="icon" 
             placeholder="e.g., ğŸ”" maxlength="2" value="ğŸ”">
    </div>
    
    <div class="form-group">
      <label class="form-label">Choice Label (short title)</label>
      <input type="text" class="form-input" data-field="label"
             placeholder="e.g., Scout the Perimeter">
    </div>
    
    <div class="form-group">
      <label class="form-label">Description (what this choice means)</label>
      <textarea class="form-textarea" data-field="description" rows="3"
                placeholder="e.g., Observe from a distance. Knowledge before action."></textarea>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
      <div class="form-group">
        <label class="form-label">Cost (Storm Shards ğŸ’)</label>
        <input type="number" class="form-input" data-field="cost" 
               placeholder="0" min="0" value="5">
      </div>
      
      <div class="form-group">
        <label class="form-label">Reward (XP)</label>
        <input type="number" class="form-input" data-field="xp"
               placeholder="15" min="0" value="15">
      </div>
    </div>
  `;
  
  container.appendChild(choiceDiv);
}

function removeChoice(id) {
  const choice = document.querySelector(`[data-choice-id="${id}"]`);
  if (choice) {
    choice.remove();
  }
}

function saveChoices() {
  const choices = [];
  const choiceElements = document.querySelectorAll('.choice-builder');
  
  choiceElements.forEach((el, index) => {
    const choiceId = `choice_${index + 1}`;
    
    choices.push({
      id: choiceId,
      icon: el.querySelector('[data-field="icon"]').value || 'ğŸ”',
      label: el.querySelector('[data-field="label"]').value || 'Untitled Choice',
      description: el.querySelector('[data-field="description"]').value || '',
      cost: parseInt(el.querySelector('[data-field="cost"]').value) || 0,
      xp: parseInt(el.querySelector('[data-field="xp"]').value) || 15
    });
  });
  
  storyData.chapters.start.choices = choices;
}

function renderChoices() {
  const container = document.getElementById('choices-container');
  container.innerHTML = '';
  
  if (storyData.chapters.start.choices.length === 0) {
    addChoice();
    addChoice();
    addChoice();
  } else {
    choiceCount = 0;
    storyData.chapters.start.choices.forEach(choice => {
      choiceCount++;
      const choiceDiv = document.createElement('div');
      choiceDiv.className = 'choice-builder';
      choiceDiv.dataset.choiceId = choiceCount;
      
      choiceDiv.innerHTML = `
        <div class="choice-header">
          <div class="choice-number">${choiceCount}</div>
          <button class="remove-choice" onclick="removeChoice(${choiceCount})">ğŸ—‘ï¸ Remove</button>
        </div>
        
        <div class="form-group">
          <label class="form-label">Choice Icon (emoji)</label>
          <input type="text" class="form-input" data-field="icon" 
                 placeholder="e.g., ğŸ”" maxlength="2" value="${choice.icon}">
        </div>
        
        <div class="form-group">
          <label class="form-label">Choice Label (short title)</label>
          <input type="text" class="form-input" data-field="label"
                 placeholder="e.g., Scout the Perimeter" value="${choice.label}">
        </div>
        
        <div class="form-group">
          <label class="form-label">Description (what this choice means)</label>
          <textarea class="form-textarea" data-field="description" rows="3"
                    placeholder="e.g., Observe from a distance.">${choice.description}</textarea>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
          <div class="form-group">
            <label class="form-label">Cost (Storm Shards ğŸ’)</label>
            <input type="number" class="form-input" data-field="cost" 
                   placeholder="0" min="0" value="${choice.cost}">
          </div>
          
          <div class="form-group">
            <label class="form-label">Reward (XP)</label>
            <input type="number" class="form-input" data-field="xp"
                   placeholder="15" min="0" value="${choice.xp}">
          </div>
        </div>
      `;
      
      container.appendChild(choiceDiv);
    });
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STORY MAP VISUALIZATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderStoryMap() {
  const container = document.getElementById('story-map');
  
  let html = '';
  
  // Starting chapter
  html += `
    <div class="map-node">
      <h4>ğŸ“– ${storyData.chapters.start.title || 'Opening Chapter'}</h4>
      <p style="color: var(--text-muted); font-size: 0.9rem;">
        ${storyData.chapters.start.text.substring(0, 150)}...
      </p>
      <div class="map-connections">
        ${storyData.chapters.start.choices.map(c => `
          <div class="connection-badge">
            ${c.icon} ${c.label}
          </div>
        `).join('')}
      </div>
    </div>
  `;
  
  // Show structure
  if (storyData.chapters.start.choices.length > 0) {
    html += `
      <div style="padding: 20px; text-align: center; color: var(--text-muted);">
        <p style="font-size: 1.1rem; margin-bottom: 15px;">
          â†“ Your story branches into ${storyData.chapters.start.choices.length} paths
        </p>
        <p style="font-size: 0.9rem;">
          ğŸ’¡ In Step 4, you'll create follow-up chapters for each choice
        </p>
      </div>
    `;
  }
  
  container.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIVE PREVIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderPreview() {
  const container = document.getElementById('preview-panel');
  
  const title = storyData.chapters.start.title || 'Your Story Title';
  const text = storyData.chapters.start.text || 'Your opening text will appear here...';
  
  let html = `
    <h2 class="preview-title">${title}</h2>
    <div class="preview-text">${text.split('\n\n').map(p => `<p>${p}</p>`).join('')}</div>
  `;
  
  if (storyData.chapters.start.choices.length > 0) {
    storyData.chapters.start.choices.forEach(choice => {
      html += `
        <div class="preview-choice">
          <div style="font-size: 2rem; margin-bottom: 10px; text-align: center;">
            ${choice.icon}
          </div>
          <div style="font-size: 1.3rem; font-weight: bold; margin-bottom: 10px; text-align: center; color: var(--primary);">
            ${choice.label}
          </div>
          <p style="text-align: center; margin-bottom: 15px;">
            ${choice.description}
          </p>
          <div style="display: flex; justify-content: center; gap: 20px; font-size: 0.9rem; color: var(--ink); opacity: 0.7;">
            ${choice.cost > 0 ? `<span>ğŸ’ ${choice.cost} Shards</span>` : ''}
            <span>âœ¨ ${choice.xp} XP</span>
          </div>
        </div>
      `;
    });
  }
  
  container.innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CODE GENERATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function generateCode() {
  const container = document.getElementById('generated-code');
  
  saveStepData();
  
  const code = `// Add this to your ZeroStorm chapters object (JavaScript SECTION 3)

start: {
  title: '${storyData.chapters.start.title || 'The Opening'}',
  
  text: \`${storyData.chapters.start.text || 'Your story begins...'}\`,
  
  choices: [
${storyData.chapters.start.choices.map(choice => `    {
      id: '${choice.id}',
      icon: '${choice.icon}',
      label: '${choice.label}',
      description: '${choice.description}',
      cost: { shards: ${choice.cost} },
      rewards: { xp: ${choice.xp} },
      requirements: {}
    }`).join(',\n')}
  ]
}

// Next: Create follow-up chapters for each choice ID:
${storyData.chapters.start.choices.map(choice => `// - ${choice.id}: Where "${choice.label}" leads`).join('\n')}`;
  
  // Syntax highlighting
  container.innerHTML = syntaxHighlight(code);
}

function syntaxHighlight(code) {
  return code
    .replace(/\/\/(.*)/g, '<span class="code-comment">//$1</span>')
    .replace(/(['"`])(.*?)\1/g, '<span class="code-string">$1$2$1</span>')
    .replace(/\b(\d+)\b/g, '<span class="code-number">$1</span>')
    .replace(/\b(const|let|var|function|return|if|else)\b/g, '<span class="code-keyword">$1</span>')
    .replace(/(\w+):/g, '<span class="code-property">$1</span>:');
}

function copyCode() {
  const code = document.getElementById('generated-code').textContent;
  navigator.clipboard.writeText(code);
  
  const btn = document.querySelector('.copy-code-btn');
  btn.textContent = 'âœ… Copied!';
  setTimeout(() => {
    btn.textContent = 'ğŸ“‹ Copy All';
  }, 2000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILITY FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function copyPrompt(promptId) {
  let prompt = '';
  
  const genre = storyData.brainstorm.genre || 'story';
  const conflict = storyData.brainstorm.conflict || 'a conflict';
  const world = storyData.brainstorm.world || 'this world';
  
  switch(promptId) {
    case 'opening1':
      prompt = `Write an opening paragraph for a ${genre} that begins with ${conflict}`;
      break;
    case 'opening2':
      prompt = `Describe the setting of ${world} through sensory details`;
      break;
    case 'opening3':
      prompt = "Write a mysterious opening that makes readers ask 'what happens next?'";
      break;
  }
  
  navigator.clipboard.writeText(prompt);
  alert('ğŸ“‹ Copied to clipboard! Paste into ChatGPT.');
}

function saveProgress() {
  saveStepData();
  alert('ğŸ’¾ Progress saved! You can close this page and return later.');
}

function exportStory() {
  saveStepData();
  
  const dataStr = JSON.stringify(storyData, null, 2);
  const dataBlob = new Blob([dataStr], { type: 'application/json' });
  const url = URL.createObjectURL(dataBlob);
  
  const link = document.createElement('a');
  link.href = url;
  link.download = `zerostorm-story-${Date.now()}.json`;
  link.click();
  
  URL.revokeObjectURL(url);
}

function downloadStory() {
  generateCode();
  const code = document.getElementById('generated-code').textContent;
  
  const blob = new Blob([code], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  
  const link = document.createElement('a');
  link.href = url;
  link.download = `zerostorm-chapters-${Date.now()}.js`;
  link.click();
  
  URL.revokeObjectURL(url);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INITIALIZATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.addEventListener('DOMContentLoaded', () => {
  // Load saved data if exists
  loadStepData();
  
  // Initialize step 3 choices if empty
  if (currentStep === 3 && document.getElementById('choices-container').children.length === 0) {
    initializeChoices();
  }
  
  console.log('ğŸŒŸ ZeroStorm Story Architect initialized');
});
</script>

</body>
</html>